- name: "Ansi Install packages"
  become: yes
  yum:
    update_cache: yes
    state: latest

- name: "pull nodejs12 artifacts"
  become: yes
  shell:
    "curl -sL https://rpm.nodesource.com/setup_12.x | sudo bash -"
  args:
    chdir: "~/"

- name: "install dependencies"
  become: yes
  yum:
    name: "nodejs"
    state: latest
    update_cache: true

- name: "clean files to push on server"
  become: yes
  shell: |
    set P = ~/react/ansible/roles/configure/files
    "rm -rf ${P}/ansible"
    "rm -rf ${P}/.circleci"
    "rm -rf ${P}/ansible.cfg"

- name: "copy all files"
  become: yes
  synchronize:
    src: /*
    dest: ~/web/
    backup: yes
    
   
- name: "run app"
  become: yes
  shell:
    "npm start"
  args:
    chdir: ~/web/