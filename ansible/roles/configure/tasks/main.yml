- name: "Ansi Install packages"
  become: yes
  yum:
    update_cache: yes
    state: latest

- name: "pull nodejs12 artifacts"
  become: yes
  shell:
    "curl -sL https://rpm.nodesource.com/setup_12.x | sudo bash -"
  args:
    chdir: "~/"

- name: "install dependencies"
  become: yes
  yum:
    name: "nodejs"
    state: latest
    update_cache: true

- name: "copy all files"
  become: yes
  synchronize:
    src: ~/react/*
    dest: ~/web/
    dirs: yes
    mode: pull
    rsync_opts:
      - "--exclude=ansible"
      - "--exclude=.circleci"
      - "--exclude=ansible.cfg"
   
- name: "run app"
  become: yes
  shell:
    "npm start"
  args:
    chdir: ~/web/